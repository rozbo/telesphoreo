diff -ru llvm-gcc-4.2-47984/gcc/config/arm/lib1funcs.asm llvm-gcc-4.2-47984+iPhone/gcc/config/arm/lib1funcs.asm
--- llvm-gcc-4.2-47984/gcc/config/arm/lib1funcs.asm	2007-11-09 02:30:15.000000000 +0000
+++ llvm-gcc-4.2-47984+iPhone/gcc/config/arm/lib1funcs.asm	2008-03-06 10:32:22.000000000 +0000
@@ -232,11 +232,7 @@
 .endm
 
 .macro FUNC_END name
-#if defined(__MACH__)
-	SIZE (__$0)
-#else
 	SIZE (__\name)
-#endif
 .endm
 
 .macro DIV_FUNC_END name
@@ -249,26 +245,15 @@
 #else
 	ARM_LDIV0 \name
 #endif
-#if defined(__MACH__)
-	FUNC_END $0
-#else
 	cfi_end	LSYM(Lend_div0)
 	FUNC_END \name
-#endif
 .endm
 
 .macro THUMB_FUNC_START name
-#if defined(__MACH__)
-	.globl	SYM ($0)
-	TYPE	($0)
-	.thumb_func
-SYM ($0):
-#else
 	.globl	SYM (\name)
 	TYPE	(\name)
 	.thumb_func
 SYM (\name):
-#endif
 .endm
 /* APPLE LOCAL end ARM MACH assembler */
 
@@ -288,15 +273,6 @@
 	
 /* APPLE LOCAL begin ARM MACH assembler */
 .macro FUNC_START name
-#if defined(__MACH__)
-	.text
-	.globl SYM (__$0)
-	TYPE (__$0)
-	FUNC_ALIGN
-	THUMB_CODE
-	THUMB_FUNC
-SYM (__$0):
-#else
 	.text
 	.globl SYM (__\name)
 	TYPE (__\name)
@@ -304,7 +280,6 @@
 	THUMB_CODE
 	THUMB_FUNC
 SYM (__\name):
-#endif
 .endm
 
 /* Special function that will always be coded in ARM assembly, even if
@@ -323,47 +298,26 @@
 	.arm
 /* A hook to tell gdb that we've switched to ARM mode.  Also used to call
    directly from other local arm routines.  */
-#if defined(__MACH__)
-_L__$0:
-#else
 _L__\name:		
-#endif
 .endm
 #define EQUIV .thumb_set
 /* Branch directly to a function declared with ARM_FUNC_START.
    Must be called in arm mode.  */
 .macro  ARM_CALL name
-#if defined(__MACH__)
-	bl	_L__$0
-#else
 	bl	_L__\name
-#endif
 .endm
 #else
 .macro	ARM_FUNC_START name
-#if defined(__MACH__)
-	.text
-	.globl SYM (__$0)
-	TYPE (__$0)
-	.align 0
-	.arm
-SYM (__$0):
-#else
 	.text
 	.globl SYM (__\name)
 	TYPE (__\name)
 	.align 0
 	.arm
 SYM (__\name):
-#endif
 .endm
 #define EQUIV .set
 .macro  ARM_CALL name
-#if defined(__MACH__)
-	bl	SYM (__$0)
-#else
-	bl	__\name
-#endif
+	bl	SYM (__\name)
 .endm
 #endif
 
